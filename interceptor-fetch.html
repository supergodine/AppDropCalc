<!DOCTYPE html>
<html>
<head>
    <title>Interceptador de Fetch</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background: #1a1a1a; color: white; }
        .log { background: #333; padding: 10px; margin: 10px 0; border-radius: 5px; }
        .error { background: #d32f2f; }
        .success { background: #388e3c; }
        .warning { background: #f57c00; }
    </style>
</head>
<body>
    <h1>üîç Interceptador de Fetch URLs</h1>
    <div id="logs"></div>
    
    <script>
        // Interceptar TODOS os fetch calls
        const originalFetch = window.fetch;
        const logs = [];
        
        function addLog(message, type = 'log') {
            console.log(message);
            logs.push({ message, type, time: new Date().toLocaleTimeString() });
            updateLogs();
        }
        
        function updateLogs() {
            const logDiv = document.getElementById('logs');
            logDiv.innerHTML = logs.map(log => 
                `<div class="log ${log.type}">[${log.time}] ${log.message}</div>`
            ).reverse().join('');
        }
        
        window.fetch = function(url, options) {
            const fullUrl = typeof url === 'string' ? url : url.toString();
            
            // Log TODA tentativa de fetch
            addLog(`üì§ FETCH: ${fullUrl}`, 'log');
            
            // Detectar URLs problem√°ticas
            if (fullUrl.includes('3002')) {
                addLog(`üö® PROBLEMA DETECTADO: URL com 3002 - ${fullUrl}`, 'error');
                
                // Mostrar stack trace para identificar origem
                console.trace('üîç Stack trace da URL problem√°tica:');
                
                // Substituir URL problem√°tica por endpoint de produ√ß√£o configurado
                const fixedUrl = fullUrl.replace(/vercel\.app:3002/, 'https://api.seu-dominio.com');
                addLog(`üîß URL CORRIGIDA: ${fixedUrl}`, 'warning');

                return originalFetch(fixedUrl, options);
            }
            
            if (fullUrl.includes('localhost')) {
                addLog(`‚ö†Ô∏è LOCALHOST DETECTADO: ${fullUrl}`, 'warning');
            }
            
            if (fullUrl.includes('provedor-deploy')) {
                addLog(`‚úÖ PROVEDOR-DE-DEPLOY OK: ${fullUrl}`, 'success');
            }
            
            return originalFetch(url, options);
        };
        
        addLog('üéØ Interceptador de fetch ativado!', 'success');
        addLog('Agora v√° para: https://app-drop-calc.example.com/login', 'log');
        addLog('E tente criar uma conta. Todas as URLs ser√£o logadas aqui.', 'log');
    </script>
</body>
</html>